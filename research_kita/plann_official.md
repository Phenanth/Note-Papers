# 研究计划书

## 研究题目

研究题目：基于贝叶斯网络与市场环境分析模型的股价预测

研究简介：本人想就**基于市场环境分析的股票指数预测**这一实际应用，在结合前人研究的基础上，继续发展**贝叶斯网络**的研究，对预测准确率以及算法运行时间的优化问题展开研究。

## 研究背景

股票价格预测这一课题从很早开始就得到了投资者与专业分析师的重视，但由于存在多方面因素的影响，只靠每日的股票数据就想掌握精准的市场动向实际存在一定困难。而使用机器学习方法则能够学习到以股票数据为基础对某只股票股价进行预测（Kita[2]，Kita[4]）的网络结构，一定程度上为此课题提供了解决方法。

除此之外，世界上的其他股票市场也会一定程度上对某市场的股票价格的走向产生影响（Others[10]）。是以，对于股票预测这一课题，需要提出一个能够在准确地认识到世界形势的基础上，对股票价格进行准确判断的数学模型。

贝叶斯网络比起神经网路或是其他机器学习方法，在预测股价趋势的表现上优于标准前馈神经网络（Others[1]，Others[2]），因为它不像常规神经网络那样通常只能找到局部最小解。不仅如此，由于贝叶斯网络能够在统计意义上充分考虑变量之间的因果关系（Others[9, 10]），在需要可视地了解不同市场之间的影响关系以及影响程度时，它也被公认为是技术上的不二选择。

## 研究目的

根据研究背景，本人决定以贝叶斯网络为训练网络的技术基础，在结合市场环境分析结果构建一个对预测准确度与计算时间进行优化的股票价格预测模型。

算法的期望成果包括以下层面：

- 股价预测模型层面

  - 提高预测准确度（Kita[2]，Others[10]，Others[11]）
  - 计算时间优化（对于Kita[2]第三算法）
- 市场环境分析模型层面
  - 在Others[10]的基础上做到对某只股票的股价进行分析

而对于模型在现实世界的应用，期望成果包括：

- 能够成为投资者的有力参考
- 找寻不同市场之间的趋势影响关系，便于经济学家对世界市场进行分析总结

## 先行研究

### BN

在`SP`或是商业领域内，`BN`的变量关系探究的能力在长期的研究下已经被证实，其中包括Others[2, 6, 13]。举例而言，Others[2]在评估精益生产对业务绩效的影响时应用了贝叶斯网络，在`Scenario Analysis`中使用`Naive Bayesian Belief Network`来评估在汽车供应链中使用不同精益工具带来的经济效益。

而在此之外，`BN`在变量之间存在已知关联性的应用场景Others[9]与环境建模Others[4 ,5]中也是很好的解决技术。举例而言，在Others[9]中，利用每日交通数据研究`Intelligent Transportation Systems`。该方法与许多现有的交通流量预测模型不同，因为它明确包含来自相邻道路链接的信息，且以统计方式分析当前路口的交通状态趋势。

综上所述，贝叶斯网络在变量关系探究的应用场景内的能力是被世人所认可的。

### SP

对于股票价格预测展开的研究中，前人已经展开了很多研究（Kita[1]，Kita[2]，Kita[4]，Others[1]，Others[8]），但其中大多数人都忽略了市场环境这个重要的因素。

Kita[4]中，作者对自身在Kita[1, 2]内提出的贝叶斯网络模型进行了改进，改进后的贝叶斯网络的结点同时由原模型的股票回报值的聚类结果以及过去预测的回报值同时作为结点构成贝叶斯网络，一定程度上提高了预测准确性。

而谈到结合市场环境，虽然前人已经分别在股票市场趋势的预测Others[11]以及结合其他股票市场走向的市场综合指数预测Others[10]上展开了一定研究，但预测准确率都差强人意。Others[10]中，模型不仅会对次日收盘指数进行预测，还能够综合考虑市场环境影响，确定哪些市场指数对指定市场指数的影响最大。

### 总结

经过先行研究，关于贝叶斯网络在股票预测课题上的优势，可以总结如下：

- 基于不完整数据的预测能力：Others[2]是精益数据不完整的情况下进行的研究，而Others[9]的作者提出由于传感器性能制约，训练数据也是偶尔出现不完整项目。但贝叶斯网络不需要靠数据假设就能够很好地对应这些不完整的数据。
- 清晰明了地反映变量关系：在Others[9]中，使用贝叶斯网络对路口关系进行图的构建就是因为能够显在地反映代表交通路口的结点间的依赖关系，由此能够了解道路流量的变化主要是因为什么路口的车流量变大导致的。Others[11]中则是直接地应用了这一点，以此来判断股市趋势走向的变化。
- 能够反映世界范围内出现的事件对股价的影响：这一点在Kita[1]与Others[10]中有涉及，本人认为能够自动地将世界范围内发生的重大事件对股市的影响反映到预测结果上这一点，是做到对市场环境综合分析的重要基础。

而目前的研究内容所存在的问题，也能够总结如下：

- 没有综合市场环境进行预测：不仅是Kita[1,2]，或者是Others[1, 11]，现存的大部分预测算法都没有将市场环境纳入建模，这就会使模型缺少了很重要的参考风向——来自其他市场的指标。
- 模型的准确率仍然不理想：虽然Others[10]提出了需要关注其他市场对研究市场的影响，但他们采用的本来是想要提高模型泛化性的`cross-validation`测验模型方法破坏了模型之内的递归关系，反而使其不适合大多数的时序分析（`Time-Series Analysis`）。

本人将会在接下来的学习期间针对以上问题点提出一定的解决方案。

## 研究方法

`训练数据的收集与预处理`：为了综合考虑世界环境的市场走向对目标市场指数趋势的影响，从网络收集世界上的12个股票市场的大盘数据并进行预处理工作。

`市场环境模型构建与市场分析`：基于以上收集的数据，参考Others[10]的手法，预训练一个能够分析对日本大盘指数产生何种影响的贝叶斯网络模型$P(h_i|d)$。在得到分析市场环境的模型$P(h_i|d)$后，首先使用该模型对市场环境进行分析，找到世界上对日本市场影响最大的市场指数的组合$S$，以及预数据来源的最佳时间窗口长短$h$。

`贝叶斯网络股价预测模型的改进`：而为了进行结合市场分析的具体股票的股价预测，在根据历史股票数据分析得到$S$和$h$的前提下，参考Kita[4]的手法，**聚类得到的回报值（`return，リターン`）取值集合以及与其对应的环境分析模型预测的趋势值作为结点构造贝叶斯网络$B''$**。使用事先处理过的股票数据进行贝叶斯网络的训练，并用实际股票`Toyota汽车`进行训练成果网络性能的评估。

## 参考文献

Kita[1]

Kita[2]

Kita[4]

Others[1]

Others[2]

Others[4]

Others[5]

Others[6]

Others[8]

Others[9]

Others[10]

Others[11]

Others[13]

