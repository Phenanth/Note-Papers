# 10

> 主要总结其手法方面的特点

劣势：

- 引入人工数据
- 因为是普通的统计概率模型，引入太多的组合条件时准确率反而下降

注意点：

- 就算有市场关闭，也只是人工添加该市场的数据而非人工添加所有市场的市场趋势数据
- 使用同样的数据集，但选择数据的手法只参考24h窗口以及每个大洲一个指数
- 随着时间窗口边长，影响实际是在变弱的

另外需要在先行研究的部分质疑原本的模型，并在手法部分说明有必要的话

- 会将此处的模型训练方法改为自动学习网络架构的方法
- 将时间窗口改为12h，也就是将市场影响范围缩小

## 2 Materials and methods

> 数据处理

此次研究中用到的世界指数有以下12种：

- `Nasdaq Composite`，USA
- `NYSE Composite`，USA
- `Dow Jones`，USA
- `Merval`，Argentina
- `Nikkei 225`，Japan
- `Shanghai Composite`，China
- `Hang Seng`，China
- `BSE 30 Sensex`，India
- `FTSE 100`，UK
- `Stockholm General`，Sweden
- `Dax`，Germany
- `Cac 40`，Fance

表一综合了各个市场的交易周期（时间），包括它们与`iBOVESPA`的重合时间。数据来自于[Yahoo! Finance的网页](https://finance.yahoo.com/)，对应20050106-20120504的数据。由于作者不想引入任何人工的数据（第三章详细讨论），任意一个市场由于周末以及假期关闭则会导致所有市场的对应日的数据被移除，最后会剩下1620/2501日。

> 网络构建，主要见`2.1`小节

使用了`5-fold cross validation`进行数据的训练和评估。在模型内部，对数据将随机地分成平均的五份（`subsets, also called folds`），在每次`validation/testing`时会有一份被随机的抽出作为验证数据，而剩下的四份作为训练数据使用，准确率是正确分类的数量除以测试集中样本的数量。

以上的步骤将被重复五次，每次都使用不同的测试集和训练集，来减少差异。总体的准确率将以五次训练的平均准确率为准。

为了更好地评估模型，分别筛选出每大洲1/2/3个不同的指标以及24h/48h（根据过去24h或者48h的数据进行训练的结果）不同的时间窗口的数据。再使用这些不同种类的数据用于预测`iBOVESPA`的隔日收市指数趋势。为此，我们将24小时窗口和48小时窗口适配到数据中，从而得到一个训练实例，其中包括`iBOVESPA`在特定日期的收市指数趋势，以及过去不同市场子集的收市指数趋势。（市场子集的选择则是由人工执行的`experimental set-up`进行选择，遵从指标是改变每大洲的指数数量，时间窗口长度以及网络的拓扑结构（下一小节会详细描述）

> 举例，一个24h每大洲1指数的训练实例由以下组成：
>
> - 第$t$天的`iBOVESPA`的收市指数趋势
> - 第$t-1$天的`American index`
> - 第$t-1$天的`European index`
> - 第$t-1$天的`Asian index`
>
> 训练实例根据每日数据构建，再被输入到学习网络中。

根据测试结果，我们找出了用于预测`iBOVESPA`的收市指数趋势的最佳以及最差表现的指数子集。由此得出了对`iBOVESPA`影响最大与最低的指数是什么的结论。接下来将会详细描述实验中使用的网络拓扑结构。

> 网络拓扑结构

由于收市时间实际和国家所在的地理位置有关，所以为了简化问题，作者将大洲相同的市场绑定在了一起，并在实验时从每个大洲内选择1/2/3个不同的指数作为数据。

<u>最初的实验阶段内</u>，选择的是在巴西收市前24h内收市（包括在巴西市场开市前或开市后）的指定市场的收市趋势作为训练数据。此模型内，一个训练实例包括巴西的收市趋势以及网络内巴西结点的父节点市场的收市趋势。（Fig. 1.）

而在每个大洲选取多个指数的实验中，所有大洲节点均被其各自的指数集合所取代。在这种情况下，同一大陆内的指数趋势被认为是彼此独立的，而大洲之间（指不同时区的市场集合）的依存关系则保持不变。也就是说欧洲和亚洲之间的关系现在对应的是所选取的所有在欧洲大陆内的指数与所有在亚洲大陆内的指数之间的依赖关系。注意，选取的市场依赖是主要根据时区选择的还不是地理位置。这意味着同一大陆上的节点仅在特定时间而不是在预测之前保持彼此独立（结合`Fig. 1.`感觉可能是在预测时认为同一个大洲内的市场之间互相独立，而预测以外的时间里就不存在这个独立关系了）。举例：即使$SP_{00}$位于美洲大陆，但仅在预测时它才独立于其他美国市场（即$America_{00}$）。但是，在过去24小时内（即America_{24}）查看这些相同的市场时，就会认为存在依赖关系。（这样做应该是为了考虑预测目标市场时算法的简便性）

根据贝叶斯理论，这个网络的数学模型是$P(h_i|d)=\frac {P(d|h_i)P(h|i)} {P(d)}$，指的是`iBOVESPA`相较于昨天的收盘指数可能会存在{high, low}两种趋势，所以会存在两种事件{h1, h2}，这两种事件在给定数据集$d$的情况下发生的概率。而根据`Fig. 1.`提出的贝叶斯网络的结点间条件依赖的条件对数学模型进行变形得到：$P(h_i|d) = P(h_i | `iBOVESPA`'s parents)$，而等式后面的部分实际上可以用每个`iBOVESPA`的父节点的取值的组合所对应的$h_i$取真的概率来估计得到（说了这么多原来是统计学）。那么网络中的每一个结点的概率的计算方法就是：根据给定在其父节点中观察到的趋势值来估计观察一个节点中特定方向的概率，从而为这些节点分配概率分布（好，玄学没跑了，而且还很绕）为了避免给没出现过的父节点组合值赋值$null$，我们还为等式加上了一个`laplace smoothing term`，也就是在计算用于估计P的频率时，将1加到分子上，将2加到分母上来避免计算上导致0/0的问题。

> - 这么多指数趋势情况排列组合后会对应多少种情况，这1600天的数据中一定会出现所有的情况吗？
> - 计算上给分子分母分别加上1和2对计算结果的准确性不会有影响吗？

<u>实验的第二阶段</u>，在24h的基础上增加了48h，（`Fig. 2.`）此方法下认为`iBOVESPA`的收市方向被24h内的其他市场直接影响，同时被48h内的其他市场间接影响。

实际的数学模型和第一实验中一样，但网络图中的父节点多出了前一天的收市数据对自身的影响（间接地被48h的其他市场影响的根据）。此外，前一天的收市数据还会对比其晚收市的其他`Amarican indices`造成影响（即使在之前的实验中，它们被认为和巴西市场是相互独立的，但是在这种情况下是个不独立的特例）。

实际的验证和上一个实验一样，最多使用到每个大洲3个指数的数据。

## 3 Results

总结一下，就是`Table 4`的内容

## 4 Discussion

对于每个大陆每个市场的指数，48小时数据的表现都比24小时数据差，这一事实可能表明随着时间的推移，其他市场对`iBOVESPA`的影响力减弱了，这使得这些市场当我们从预测日期移到过去时，其行为更

像是噪音。使用我们的模型，不仅可以识别这些影响的存在，还可以量化它们，并验证它们随时间减少的速率，并找到何时影响彻底消失只剩下噪声。由于易于理解，因此可以用来指导投资策略，因为可以用概率和频率来解释结果。

该模型的另一种可能用途是直接确定哪些市场对`iBOVESPA`的影响最大，即在危机期间减少可能的市场污染来源，那么在危机发生时就能够反映出哪个市场最容易对目标市场传递危机的影响效果。

自然，考虑到全球市场性质的变化，随着经济的重要性以不同的步伐增长，人们不能指望那些今天影响某种指数的市场在未来仍然能够保持同样的影响力。幸运的是，该模型易于适应变化，训练新的网络只是进行新的频率分析即可。由此能够知道，这个模型能够应用于任何一个市场来找到市场依赖，而且比一些黑盒模型更具优势——它的判断过程对人来说是直观的。

劣势方面，贝叶斯网络的固定拓扑结构使得它对结构的变化并没有那么好的适应性，比如需要考虑大洲内的依赖关系时，会打破之前的独立假设。一种解决方法可以是自动进行网络的架构的学习。但是，这很少会导致朴素的贝叶斯结构（提到Kita的研究），在给定输出节点的值的情况下，所有节点都被视为独立的。此外，本次研究使用的是经济危机期间的数据，而经济学家指出在危机期间的世界市场和会呈现一致的趋势，且这样的趋势也只会存在于危机期间。

最后**不应该去除有部分市场关闭的日子里的其他市场的数据**。因为为了补偿去除了的所有其他市场数据，我们为了让24h窗口保持连续，还是人工地引入了前一天的市场趋势（比如让去除的那天的趋势与前一天相同），最后的结果就是数据的人工成分比之前更大了。（虽然167天的假期里有很多是各国共享的假日）总之，网络还指出随着时间被拉长，影响实际是变弱的。（后面那句没看懂）

> 接下来是看过的

