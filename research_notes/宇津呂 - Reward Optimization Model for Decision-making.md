# A Reward Optimization Model for Decision-making under Budget Constraint

> 英文，翻译标题应该是【带预算约束并用于决策的回馈优化模型】

论文旨在设计一种能够通过受限的一系列数据学习到随机函数的新型预测模型。在建立泛化能力较强的用于进行函数预测的模型时，插值算法是一种较为常见的监督学习方法。然而，类似回归或者线性SVM这种被预定义的代数表达式限制的函数形式是不适合用于学习无限参数的模糊函数的。除此之外，虽然得到充分训练的神经网络能够计算出泛化能力好的函数，但是在一些实际的类似于在线推荐这种场景中，学习过程所需要的数据量将会大到超出想象。

提出模型能够解决以上两种问题，基于一种半参数的图模型以及贝叶斯估计来实现对小数据量进行估计参数的提取。同时存在一个`online`函数来展示模型是如何在确定最佳全局函数时对决策过程造成影响的，决定一个好的全局函数也是在作出最佳决策时最重要的目标。

在模型评估上，会使用一系列采样方法来抽取训练数据，以展现使用提出方法训练出的优化推荐策略将会在什么程度上提高决策的正确率。经验评估总结得到结合`Thompson采样`改进的版本能够让提出算法训练出表现更好的策略。

关键字：增强学习，概率图模型，多臂抽奖问题，推荐系统

前置知识

- `MAB`（[参考](https://zhuanlan.zhihu.com/p/21388070)）
  - `Thompson sampling`
- `CTR`
- `graphical model`
  - `hybrid graph`
- 马尔科夫随机场

> 看到2结束，这篇论文好难。

## 1 Intro

> 前略
>
> This paper models this initilization problems（解决参数无限和需要样本量过大的问题） as reward optimization with exploration-exploitation trade-off under the paradigm of the multi-armed bandit problems, in which an agent always seeks for the candidate of the highest CTR`click through rate`

- 将`MAB`的用于寻找最高`CTR`的候选方法的代理作为参考对象（`paradigm`），提出模型能够使用`探索-采集`的权衡方法，把存在的初始化问题视为反馈优化问题进行建模。
- `MAB`不会考虑自己行为对环境的影响，但本模型的`online step`考虑了
- 预算的表现形式是一个总推荐次数的计数器
- 反馈模型表现形式是根据实际用户是否点击广告，从而体现的每次点击所收获的广告费用

具体的解决方案分成两步：

1. 第一部分是图模型。图模型从受限的`CTR`样本中学习并利用最大后验估计在随机模型中进行演绎。将多维环境中存在的多个训练`item`的评判标准`indices`分裂成多个方向，并分别将每个`item`的`CTR`描述为切合这多个方向的形式，这样`item`的最终表示方法就能够体现多维环境的所有特征。由于满足随机马尔科夫场的特征，所以结果可以根据多元高斯协方差进行多个变量之间的计算。好处就是图模型里面的节点数量只取决于`item`数量而非样本数量（比起传统贝叶斯回归），减少了计算复杂度。
2. 第二部分是基于样本的决策策略。图模型的输出将会提供每个`item`的后验反馈，于是选择最好的`item`就被化解成了`MAB`问题。实际的决策策略是一个`Thompson sampling`的变体，能够基于第一部分对`item`的积累经验，通过积累的`density`选择一个能够将`CTR`的期望值最大化的`item`。最后将提出算法与解决`ee`问题的传统算法作比较，例如使用认知函数或者`naive epsilon greedy method`。

对下面内容的组织进行介绍：

1. 简介
2. 图模型
   1. 定义
   2. 满足随机马尔科夫场性质的证明推导
   3. 概率正确性的推导计算
3. 模型的学习过程
   1. 一行同时包括决策过程以及模型调整的算法内容。
4. 对算法的实验
   1. 模拟场景以及
   2. 真实`CTR`测试工具集上的结果。
5. 总结以及对实验结果的论述。

## 2 图模型

### 2.1 Problem Nature

- 从回馈样本中学习模型，混入样本噪音
- 计算特征合计最大估计值就能够确定基于样本集合的最佳索引$i$的问题。于是最佳结果就转化为了参数问题。

### 2.2 图模型的表示标准

一个拥有与随机马尔科夫场和由贝叶斯网络组织的子组件的`hybrid`图

#### 2.2.1 马尔科夫属性

马尔科夫属性是指一个隐藏层结点只受到它周围相邻结点的影响。而对其他非邻接的结点没有依赖关系。

所以模型有这样的特点：

信仰（`belief`）不会传递到邻接结点之外，全连接子图会被称为`clique`，场概率分布就是根据这样的子图计算。此论文中`clique`使用高斯函数来定义邻接概率。

与此匹配的会有一些代表邻接结点之间联系紧密度的参数，<u>省略</u>。

#### 2.2.2 贝叶斯属性

马尔科夫场里的每个结点拥有的回馈$r_i$实际表现为一个被采样（在训练时接收复数个样本带来的影响）的列表。为了让隐藏结点之间`density`得到妥当设置，在处理信仰在回馈样本到隐藏结点之间传递时，实际使用了贝叶斯属性对子组件作出了优化。又可以表现为：贝叶斯假设下，每个目标结点初始化带有一个先验知识和于周围结点的连接强度。

> 省略结点之间的连接关系定义公式。

为了防止公式内包含的每个样本的代表数字带来的运算复杂度的增加，将每个单独的参数替换成了平均值，得到在连接条件下回馈列表带来的每个子方向的的连接参数。

> 这一段神神叨叨的，说实话没看懂。
>
> 还有在隐藏结点对反馈的依赖形式上，从各自依赖自己的反馈变成了全局反馈。

在经过一系列变形简化（变成完全平方形式了），可以得到简化后的贝叶斯网络公式。

> 数学不好，哭了

#### 2.2.3 最终表达形式

将饼图注记法的结点值计算方式替换成了`GMRF`高斯马尔科夫随机场原理，然后用贝叶斯网络代替结点之间的组织计算方式（概率图？）。

> 还有好多公式